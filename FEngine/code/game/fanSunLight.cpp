#include "fanGlobalIncludes.h"
#include "game/fanSunLight.h"


#include "scene/fanGameobject.h"


namespace fan {
	REGISTER_EDITOR_COMPONENT( SunLight )
	REGISTER_TYPE_INFO( SunLight )

	//================================================================================================================================
	//================================================================================================================================
	void SunLight::Start() {
		
	}

	//================================================================================================================================
	//================================================================================================================================
	void SunLight::OnAttach() {
		Actor::OnAttach();
	}

	//================================================================================================================================
	//================================================================================================================================
	void SunLight::OnDetach() {
		Actor::OnDetach();
	}

	//================================================================================================================================
	//================================================================================================================================
	void SunLight::Update(const float /*_delta*/) {
	}

	//================================================================================================================================
	//================================================================================================================================
	void SunLight::LateUpdate( const float /*_delta*/ )
	{}

	
	//================================================================================================================================
	//================================================================================================================================
	void SunLight::OnGui()
	{
		ImGui::PushItemWidth( 0.6f * ImGui::GetWindowWidth() );
		{
			// Mesh generation
			ImGui::Checkbox( "debug draw", &ecsSolarEruptionMeshSystem::s_debugDraw );
			ImGui::DragFloat( "radius", &ecsSolarEruptionMeshSystem::s_radius, 0.1f );
			ImGui::DragFloat( "sub-angle", &ecsSolarEruptionMeshSystem::s_subAngle, 1.f, 1.f, 180.f );
		} ImGui::PopItemWidth();
	}

	//================================================================================================================================
	//================================================================================================================================
	bool SunLight::Load( Json & _json) {
		Actor::Load(_json);
		LoadFloat( _json, "radius", ecsSolarEruptionMeshSystem::s_radius );
		LoadFloat( _json, "sub_angle", ecsSolarEruptionMeshSystem::s_subAngle );

		return true;
	}

	//================================================================================================================================
	//================================================================================================================================
	bool SunLight::Save( Json & _json ) const {
		Actor::Save( _json );		
		SaveFloat( _json, "radius", ecsSolarEruptionMeshSystem::s_radius );
		SaveFloat( _json, "sub_angle", ecsSolarEruptionMeshSystem::s_subAngle );
		return true;
	}
}